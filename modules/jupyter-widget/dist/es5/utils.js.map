{"version":3,"sources":["../../src/utils.js"],"names":["loadCss","url","link","document","createElement","type","rel","href","getElementsByTagName","appendChild","createWidgetDiv","idName","width","height","div","style","id","createCanvas","canvas","Object","assign","position","createMapDiv","hideMapboxCSSWarning","missingCssWarning","getElementsByClassName","display","createDeckScaffold","rootElement","uid","mapNode","canvasNode","mapWrapperNode","waitForElementToDisplay","selector","time","cb","querySelector","setTimeout","setMapProps","map","props","viewState","longitude","latitude","jumpTo","center","zoom","Number","isFinite","bearing","pitch","deckStyle","setStyle","uuidv4","replace","c","r","Math","random","v","toString"],"mappings":"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","sourcesContent":["/* global document,setTimeout */\n/**\n * Gets CSS from a given URL and appends it to the document head\n * @param url URL of CSS page\n */\nfunction loadCss(url) {\n  const link = document.createElement('link');\n  link.type = 'text/css';\n  link.rel = 'stylesheet';\n  link.href = url;\n  document.getElementsByTagName('head')[0].appendChild(link);\n}\n\n/**\n * Creates a div of a default 500px by 500px for the Jupyter widget\n * @param idName ID attribute of div\n * @param width Width of div in pixels (defaults to 500)\n * @param height Height of div in pixels (defaults to 500)\n * @return div object for appending to the document\n */\nfunction createWidgetDiv(idName, width = 500, height = 500) {\n  const div = document.createElement('div');\n  div.style.width = `${width}px`;\n  div.style.height = `${height}px`;\n  div.id = idName;\n  return div;\n}\n\n/**\n * Creates a canvas for the Jupyter widget\n * @param idName ID attribute of canvas\n * @return canvas canvas for appending\n */\nfunction createCanvas(idName) {\n  const canvas = document.createElement('canvas');\n  Object.assign(canvas.style, {\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    'z-index': 2\n  });\n  canvas.id = idName;\n  return canvas;\n}\n\n/**\n * Creates a div for the Jupyter widget's basemap\n * @param idName ID attribute of div\n * @return div object for appending to the document\n */\nfunction createMapDiv(idName) {\n  const div = document.createElement('div');\n  Object.assign(div.style, {\n    'pointer-events': 'none',\n    height: '100%',\n    width: '100%',\n    position: 'absolute',\n    'z-index': 1\n  });\n  div.id = idName;\n  return div;\n}\n\n/**\n * Hides a warning in the mapbox-gl.js library from surfacing in the notebook as text.\n */\nfunction hideMapboxCSSWarning() {\n  const missingCssWarning = document.getElementsByClassName('mapboxgl-missing-css')[0];\n  if (missingCssWarning) {\n    missingCssWarning.style.display = 'none';\n  }\n}\n\n/**\n * Creates and appends all DOM elements for the deck.gl widget at the specified root node\n * @param rootElement ID attribute of div\n * @uid Unique tag for the element ID\n * @width Width of widget div element, in pixels\n * @height Height of widget div element, in pixels\n */\nfunction createDeckScaffold(rootElement, uid, width = 500, height = 500) {\n  const mapNode = createMapDiv(`map-${uid}`);\n  const canvasNode = createCanvas(`deck-map-container-${uid}`);\n  const mapWrapperNode = createWidgetDiv(`deck-map-wrapper-${uid}`, width, height);\n  mapWrapperNode.appendChild(canvasNode);\n  mapWrapperNode.appendChild(mapNode);\n  rootElement\n    .appendChild(createWidgetDiv(`deck-container-${uid}`, width, height))\n    .appendChild(mapWrapperNode);\n}\n\n/**\n * Awaits an element to display before running another action\n * @param selector Attribute to await\n * @param time Check interval in milliseconds\n * @param cb Callback to execute when the element is found\n */\nfunction waitForElementToDisplay(selector, time, cb) {\n  if (document.querySelector(selector) !== null) {\n    cb();\n    return;\n  }\n  setTimeout(() => {\n    waitForElementToDisplay(selector, time, cb);\n  }, time);\n}\n\n/**\n * Sets common properties for basemap\n * @param map ID attribute of div\n * @param props ID attribute of div\n * @return div object for appending to the document\n */\nfunction setMapProps(map, props) {\n  if ('viewState' in props && props.viewState.longitude && props.viewState.latitude) {\n    const {viewState} = props;\n    map.jumpTo({\n      center: [viewState.longitude, viewState.latitude],\n      zoom: Number.isFinite(viewState.zoom) ? viewState.zoom : 10,\n      bearing: viewState.bearing || 0,\n      pitch: viewState.pitch || 0\n    });\n  }\n\n  if (props.map && 'style' in props.map) {\n    if (props.map.style !== map.deckStyle) {\n      map.setStyle(props.map.style);\n      map.deckStyle = props.map.style;\n    }\n  }\n}\n\n/**\n * Creates a v4 UUID\n */\nfunction uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\n    const r = (Math.random() * 16) | 0;\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\nexport {\n  createDeckScaffold,\n  loadCss,\n  hideMapboxCSSWarning,\n  setMapProps,\n  waitForElementToDisplay,\n  uuidv4\n};\n"],"file":"utils.js"}