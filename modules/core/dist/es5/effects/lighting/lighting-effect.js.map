{"version":3,"sources":["../../../../src/effects/lighting/lighting-effect.js"],"names":["DefaultAmbientLightProps","color","intensity","DefaultDirectionalLightProps","direction","LightingEffect","Effect","constructor","props","ambientLight","directionalLights","pointLights","key","lightSource","type","push","applyDefaultLights","getParameters","layer","getProjectedPointLights","getProjectedDirectionalLights","lightSources","length","AmbientLight","DirectionalLight","projectedPointLights","i","pointLight","getProjectedLight","projectedDirectionalLights","directionalLight"],"mappings":"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","sourcesContent":["import {AmbientLight} from '@luma.gl/core';\nimport DirectionalLight from './directional-light';\nimport Effect from '../../lib/effect';\n\nconst DefaultAmbientLightProps = {color: [255, 255, 255], intensity: 1.0};\nconst DefaultDirectionalLightProps = [\n  {\n    color: [255, 255, 255],\n    intensity: 1.0,\n    direction: [-1, -3, -1]\n  },\n  {\n    color: [255, 255, 255],\n    intensity: 0.9,\n    direction: [1, 8, -2.5]\n  }\n];\n\n// Class to manage ambient, point and directional light sources in deck\nexport default class LightingEffect extends Effect {\n  constructor(props) {\n    super(props);\n    this.ambientLight = null;\n    this.directionalLights = [];\n    this.pointLights = [];\n\n    for (const key in props) {\n      const lightSource = props[key];\n\n      switch (lightSource.type) {\n        case 'ambient':\n          this.ambientLight = lightSource;\n          break;\n\n        case 'directional':\n          this.directionalLights.push(lightSource);\n          break;\n\n        case 'point':\n          this.pointLights.push(lightSource);\n          break;\n        default:\n      }\n    }\n    this.applyDefaultLights();\n  }\n\n  getParameters(layer) {\n    const {ambientLight} = this;\n    const pointLights = this.getProjectedPointLights(layer);\n    const directionalLights = this.getProjectedDirectionalLights(layer);\n    return {\n      lightSources: {ambientLight, directionalLights, pointLights}\n    };\n  }\n\n  // Private\n  applyDefaultLights() {\n    const {ambientLight, pointLights, directionalLights} = this;\n    if (!ambientLight && pointLights.length === 0 && directionalLights.length === 0) {\n      this.ambientLight = new AmbientLight(DefaultAmbientLightProps);\n      this.directionalLights.push(new DirectionalLight(DefaultDirectionalLightProps[0]));\n      this.directionalLights.push(new DirectionalLight(DefaultDirectionalLightProps[1]));\n    }\n  }\n\n  getProjectedPointLights(layer) {\n    const projectedPointLights = [];\n\n    for (let i = 0; i < this.pointLights.length; i++) {\n      const pointLight = this.pointLights[i];\n      projectedPointLights.push(pointLight.getProjectedLight({layer}));\n    }\n    return projectedPointLights;\n  }\n\n  getProjectedDirectionalLights(layer) {\n    const projectedDirectionalLights = [];\n\n    for (let i = 0; i < this.directionalLights.length; i++) {\n      const directionalLight = this.directionalLights[i];\n      projectedDirectionalLights.push(directionalLight.getProjectedLight({layer}));\n    }\n    return projectedDirectionalLights;\n  }\n}\n"],"file":"lighting-effect.js"}